<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Ride Search</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- link calendar resources -->
    <link rel="stylesheet" type="text/css" href="calendar/tcal.css" />
    <script type="text/javascript" src="calendar/tcal.js"></script>
    
    <!-- jQuery library and related functions -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script> // include header
    $(function(){
      $("#header").load("header.html"); 
    });
    </script>
    <script type="text/javascript" src="jquery.cookie.js"></script>
	<script src="helperFunctions.js"></script>
	
	<!-- parse library -->
    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
	
	<!-- encapsulates objects and related functions -->
    <script src="ride.js"></script>
    <script src="userMsg.js"></script>

  </head>

  <body>
    
    <div id="header"></div>
    
    <div id="wrapper">

        <h1>Ride Search</h1>
        <section class="form">
			<form>
				<div class="formField">
					<label for="origin">Origin: </label>
					<input type="text" id="origin">
					
					<br/>

					<label for="destination">Destination: </label>
					<input type="text" id="destination">
					
					<br/>

					<label for="date">Date: </label>
					<input type="text" name="date" class="tcal" value="" size="21" id="date"/>
					
					<br/>

					<label for="searchRides">Search Rides: </label>
					<input type="button" id="searchRides" value="Click">
				</div>
			</form>
        </section>

    </div>
    
    <script>
    $(document).ready(function(){
 
        $("#searchRides").click(function(){
            var origin = $("#origin").val();
            var destination  = $("#destination").val();
            var date = $("#date").val();
        
            var searchRides = $(function(){
                Parse.initialize("QcwXhisuq1pu4BqEo7PJ2mhqNb60zxTirYIhuUYq", "4k6woAZq5BaTmLFMNIv7dL4X2SshOkW5Hy4sRnmL");
                
                var Ride = Parse.Object.extend("Ride");//create Ride class, subclass of Parse.Object
                var query = new Parse.Query(Ride);//create instance of Ride Class, called query
                
                if(origin != ''){query.equalTo("origin",origin);}
                if(destination != ''){query.equalTo("destination",destination);}
                if(date != ''){query.equalTo("date", date);}

                query.find({
                  success: function(results) {
                    var rideArray = new Array();
                    // The object was retrieved successfully.

                    for (var i = 0; i < results.length; i++) { 
                      var object = results[i];
                     // alert(object.id + ' - ' + object.get('destination'));
                      rideArray.push(object.id);
                    }
                  window.location = "rideSearchResults.html?"+rideArray;
                  },
                  error: function(object, error) {
                    // The object was not retrieved successfully.
                    // error is a Parse.Error with an error code and description.
                    alert("error");
                  }
                });
                
                
            });
        });
    });
    </script>
    
  </body>

</html>
